<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Scapular & Rib Program</title>
<style>
/* ... keep your existing styles above ... */

.item{display:grid;grid-template-columns:28px 1fr 280px;gap:12px;align-items:start;padding:12px;border-top:1px dashed var(--border)}
/* Make the instructions panel roomy and tappable */
details{background:#121217;border:1px solid var(--border);border-radius:8px;padding:8px}
summary{cursor:pointer;color:var(--accent);outline:none;padding:8px 6px;font-weight:600}
summary::-webkit-details-marker{display:none}
summary::before{content:"▶ ";font-size:0.9em}
details[open] summary::before{content:"▼ "}
.details-body{color:#ddd;font-size:0.95rem;line-height:1.5;margin-top:6px}
ul{margin:6px 0 0 18px}

/* ===== Mobile layout fix ===== */
@media (max-width: 860px){
  /* Switch to two columns: checkbox + content */
  .item{grid-template-columns:24px 1fr;gap:10px;padding:10px}
  /* Make the instructions span the full width under the label */
  .item details{grid-column: 1 / -1; margin-top:6px}
  /* Slightly larger tap targets */
  summary{font-size:1rem;padding:10px 8px}
  .details-body{font-size:0.98rem}
}
</style>
</head>
<body>
<header>
  <h1>Scapular & Rib Program</h1>
  <p class="subtitle">Click “Instructions” for step‑by‑step cues • Progress & streak tracking</p>
  <div class="top-actions">
    <button id="markAll">Mark all done</button>
    <button id="clearToday">Clear today</button>
    <button id="exportData">Export progress</button>
  </div>
  <div id="summary">
    <div><strong>Today:</strong> <span id="todayDate"></span></div>
    <div><strong>Completed:</strong> <span id="completedCount">0</span>/<span id="totalCount">0</span></div>
    <div class="progress"><div id="bar"></div></div>
    <div><strong>Streak:</strong> <span id="streak">0</span> days • <strong>Total sessions:</strong> <span id="totalSessions">0</span></div>
  </div>
</header>

<main id="plan"></main>

<footer>
  <p>Flow: Core/Rib → Activation → Strength → Stretch. Keep left ribs down throughout.</p>
</footer>

<script>
const PLAN = [
  {section:"Core / Rib Control", items:[
    {
      name:"90/90 Breathing with Left Reach",
      side:"Left",
      sets:"3", reps:"5 breaths",
      notes:"Exhale fully; pull LEFT ribs down; reach gently with left arm.",
      instr:`
      <div class="details-body">
        <strong>Setup</strong>
        <ul>
          <li>Lie on your back; hips and knees at 90° (shins parallel to floor).</li>
          <li>Left arm reaches to the ceiling; right arm relaxed by side.</li>
        </ul>
        <strong>How</strong>
        <ul>
          <li>Inhale quietly through the nose, keep lower ribs heavy.</li>
          <li>Exhale through the mouth like blowing out candles; <em>pull LEFT ribs down</em> and gently posteriorly tilt pelvis.</li>
          <li>As you exhale, reach the <em>left</em> hand up 1–2 cm (shoulder protraction) without shrugging.</li>
          <li>Pause 2s, then soft nasal inhale keeping ribs down. Repeat.</li>
        </ul>
        <strong>Cues</strong>
        <ul>
          <li>Feel abs engage low/left. No neck tension. Low back stays on floor.</li>
        </ul>
      </div>`
    },
    {
      name:"Dead Bug (Left Focus)",
      side:"Left",
      sets:"2", reps:"8 per side",
      notes:"Keep LEFT ribs tucked; move slow and controlled.",
      instr:`
      <div class="details-body">
        <strong>Setup</strong>
        <ul>
          <li>On back, hips/knees at 90°, arms to ceiling.</li>
        </ul>
        <strong>How</strong>
        <ul>
          <li>Exhale to set ribs down. Keep LEFT ribs down the whole set.</li>
          <li>Opposite arm/leg move: right arm overhead as left leg extends; switch.</li>
          <li>Only reach as far as you can keep ribs down (no back arch).</li>
        </ul>
        <strong>Cues</strong>
        <ul>
          <li>Belly “hollows” slightly on exhale; low back kisses floor, not jams.</li>
        </ul>
      </div>`
    },
    {
      name:"Side Plank",
      side:"Left",
      sets:"2", reps:"20–30 sec",
      notes:"Stack ribs over pelvis; no sag or flare.",
      instr:`
      <div class="details-body">
        <strong>Setup</strong>
        <ul><li>Left forearm under shoulder, legs straight and stacked.</li></ul>
        <strong>How</strong>
        <ul>
          <li>Lift hips; think <em>ribs down</em> and <em>glutes tight</em>.</li>
          <li>Hold; breathe light through nose without losing alignment.</li>
        </ul>
        <strong>Cues</strong>
        <ul>
          <li>Imagine zippering ribs toward pelvis; keep neck long; no shrug.</li>
        </ul>
      </div>`
    }
  ]},

  {section:"Scapular Activation", items:[
    {
      name:"Wall Angels",
      side:"Both",
      sets:"2", reps:"10",
      notes:"Keep lower back and ribs on wall; move slow.",
      instr:`
      <div class="details-body">
        <strong>Setup</strong>
        <ul>
          <li>Back, head, and <em>ribs</em> against the wall; feet 6–12 in forward.</li>
          <li>Arms at 90°/90° (goalpost), wrists/back of hands lightly touching wall.</li>
        </ul>
        <strong>How</strong>
        <ul>
          <li>Slide arms up as high as you can while keeping ribs down and wrists near the wall.</li>
          <li>Lower with control. No shrugging.</li>
        </ul>
        <strong>Cues</strong>
        <ul><li>Think “long neck, ribs heavy, shoulder blades glide.”</li></ul>
      </div>`
    },
    {
      name:"Serratus Wall Slides",
      side:"Right",
      sets:"2", reps:"10",
      notes:"Protract at the top; avoid upper‑trap shrug.",
      instr:`
      <div class="details-body">
        <strong>Setup</strong>
        <ul><li>Forearms on wall at shoulder width, elbows ~90°.</li></ul>
        <strong>How</strong>
        <ul>
          <li>Slide up while lightly pushing forearms into wall, then at the top “push the wall away” (shoulder blades wrap forward).</li>
          <li>Lower without collapsing.</li>
        </ul>
        <strong>Cues</strong>
        <ul><li>Feel it under the armpit (serratus), not in neck.</li></ul>
      </div>`
    },
    {
      name:"Scap Retraction & Depression Hold",
      side:"Left",
      sets:"2", reps:"10 (3s hold)",
      notes:"Pull shoulder blade DOWN and IN without shrugging.",
      instr:`
      <div class="details-body">
        <strong>Setup</strong>
        <ul><li>Sit or stand tall; arm by side.</li></ul>
        <strong>How</strong>
        <ul>
          <li>Gently draw the left shoulder blade back (retract) and down (depress) as if sliding into a back pocket.</li>
          <li>Hold 3s; relax. Repeat.</li>
        </ul>
        <strong>Cues</strong>
        <ul><li>Chest stays quiet; no rib flare; no upper‑trap pinch.</li></ul>
      </div>`
    }
  ]},

  {section:"Strength – Right (Wing Fix)", items:[
    {
      name:"Serratus Punch",
      side:"Right",
      sets:"3", reps:"12",
      notes:"Punch the ceiling with a straight elbow; scapula wraps forward.",
      instr:`
      <div class="details-body">
        <strong>Setup</strong>
        <ul><li>Lie on back, light DB in right hand, arm straight above shoulder.</li></ul>
        <strong>How</strong>
        <ul>
          <li>Without bending the elbow, reach the DB toward the ceiling to lift the shoulder blade off the floor slightly.</li>
          <li>Lower slowly till shoulder blade returns to floor.</li>
        </ul>
        <strong>Cues</strong>
        <ul><li>Feel it under the armpit (serratus). Keep ribs down.</li></ul>
      </div>`
    },
    {
      name:"Prone Y‑T‑W (Right Emphasis)",
      side:"Right emphasis",
      sets:"2", reps:"10 each shape",
      notes:"Pause 2–3s at top on the right side.",
      instr:`
      <div class="details-body">
        <strong>Setup</strong>
        <ul><li>Lie prone on bench/floor, forehead supported, thumbs up.</li></ul>
        <strong>How</strong>
        <ul>
          <li><strong>Y:</strong> Arms overhead in a “Y”, lift with lower trap.</li>
          <li><strong>T:</strong> Arms out to sides, squeeze mid‑back (no shrug).</li>
          <li><strong>W:</strong> Bend elbows ~90°, pinch shoulder blades gently.</li>
        </ul>
        <strong>Cues</strong>
        <ul><li>Keep neck long, ribs quiet; right side 2–3s pause at top.</li></ul>
      </div>`
    }
  ]},

  {section:"Strength – Left (Lower Trap)", items:[
    {
      name:"Prone Y Raise",
      side:"Left",
      sets:"3", reps:"12",
      notes:"Lead with thumb; think shoulder blade down & in.",
      instr:`
      <div class="details-body">
        <strong>Setup</strong>
        <ul><li>Prone on bench/floor, left arm in “Y”.</li></ul>
        <strong>How</strong>
        <ul>
          <li>Lift the left arm slightly off the floor, reaching long.</li>
          <li>Lower slow; keep shoulder away from ear.</li>
        </ul>
        <strong>Cues</strong>
        <ul><li>Lower trap should work; no upper‑trap take‑over.</li></ul>
      </div>`
    },
    {
      name:"Lat Prayer Lift",
      side:"Left",
      sets:"3", reps:"10",
      notes:"Band anchored low; pull diagonally without rib flare.",
      instr:`
      <div class="details-body">
        <strong>Setup</strong>
        <ul><li>Kneel with band anchored low to your left.</li></ul>
        <strong>How</strong>
        <ul>
          <li>With arm straight, pull band up/diagonal toward forehead.</li>
          <li>Control back down.</li>
        </ul>
        <strong>Cues</strong>
        <ul><li>Ribs down; feel lat + lower trap, not neck.</li></ul>
      </div>`
    }
  ]},

  {section:"Strength – Both", items:[
    {
      name:"Single‑arm Band Row → External Rotation",
      side:"Both",
      sets:"3", reps:"12 each",
      notes:"Row to ribs, then rotate to 90°—control both phases.",
      instr:`
      <div class="details-body">
        <strong>Setup</strong>
        <ul><li>Band anchored at mid‑chest height.</li></ul>
        <strong>How</strong>
        <ul>
          <li>Row elbow to ribs (scapula back & down), pause.</li>
          <li>Then externally rotate to ~90° elbow angle; pause; return.</li>
        </ul>
        <strong>Cues</strong>
        <ul><li>Chest quiet; no rib pop; smooth tempo.</li></ul>
      </div>`
    }
  ]},

  {section:"Stretch", items:[
    {
      name:"Doorway Pec Stretch",
      side:"Both",
      sets:"2", reps:"30 sec",
      notes:"Elbow ~90°; step forward until mild stretch—no numbness.",
      instr:`
      <div class="details-body">
        <strong>How</strong>
        <ul>
          <li>Forearm on doorframe, elbow ~shoulder height.</li>
          <li>Step forward, rotate chest away slightly.</li>
        </ul>
        <strong>Cues</strong>
        <ul><li>Breathe; ribs down; feel front‑chest stretch (not shoulder pinch).</li></ul>
      </div>`
    },
    {
      name:"Upper Trap Stretch",
      side:"Both (more on right if tight)",
      sets:"2", reps:"30 sec",
      notes:"Keep shoulder down; gentle only.",
      instr:`
      <div class="details-body">
        <strong>How</strong>
        <ul>
          <li>Hold edge of chair with right hand; tilt head left.</li>
          <li>Option: light over‑pressure with left hand on head.</li>
        </ul>
        <strong>Cues</strong>
        <ul><li>Shoulder stays depressed; slow nasal breaths.</li></ul>
      </div>`
    }
  ]}
];

const todayKey = () => new Date().toISOString().slice(0,10);
const storage = { get:(k,d)=>JSON.parse(localStorage.getItem(k)||JSON.stringify(d)), set:(k,v)=>localStorage.setItem(k,JSON.stringify(v)) };
const DATA_KEY = 'scap_rib_progress_v1_text';
const STATE_KEY = 'scap_rib_checked_v1_text';

let totalItems = 0;
const planEl = document.getElementById('plan');

PLAN.forEach(section=>{
  const card=document.createElement('div'); card.className='card';
  const h=document.createElement('h2'); h.textContent=section.section; card.appendChild(h);

  section.items.forEach((it,idx)=>{
    totalItems++;
    const row=document.createElement('div'); row.className='item';

    const cb=document.createElement('input'); cb.type='checkbox'; cb.id=section.section+'_'+idx;

    const label=document.createElement('label'); label.setAttribute('for', cb.id);
    label.innerHTML = `<strong>${it.name}</strong><br><small>${it.side}</small><br><small>Sets: ${it.sets} • Reps/Time: ${it.reps}</small><br><small><em>${it.notes}</em></small>`;

    const det=document.createElement('details');
    const sum=document.createElement('summary'); sum.textContent='Instructions';
    const body=document.createElement('div'); body.innerHTML = it.instr;
    det.appendChild(sum); det.appendChild(body);

    row.appendChild(cb);
    row.appendChild(label);
    row.appendChild(det);
    card.appendChild(row);
  });

  planEl.appendChild(card);
});
document.getElementById('totalCount').textContent=totalItems;

// Progress logic
function loadToday(){
  const checked=storage.get(STATE_KEY+'_'+todayKey(),{});
  document.querySelectorAll('.item input[type=checkbox]').forEach(cb=>{
    cb.checked=!!checked[cb.id];
    cb.onchange=()=>{checked[cb.id]=cb.checked;storage.set(STATE_KEY+'_'+todayKey(),checked);updateSummary();maybeLogSession();}
  });
  updateSummary();
}
function updateSummary(){
  document.getElementById('todayDate').textContent=todayKey();
  const checked=storage.get(STATE_KEY+'_'+todayKey(),{});
  const count=Object.values(checked).filter(Boolean).length;
  document.getElementById('completedCount').textContent=count;
  document.getElementById('bar').style.width=Math.round((count/totalItems)*100)+'%';
}
function markAllDone(){
  const checked={};
  document.querySelectorAll('.item input[type=checkbox]').forEach(cb=>{cb.checked=true;checked[cb.id]=true;});
  storage.set(STATE_KEY+'_'+todayKey(),checked);
  updateSummary();logSession();
}
function clearToday(){
  storage.set(STATE_KEY+'_'+todayKey(),{});
  document.querySelectorAll('.item input[type=checkbox]').forEach(cb=>cb.checked=false);
  updateSummary();
}
function logSession(){
  const data=storage.get(DATA_KEY,{history:[],streak:0,lastDate:null,sessions:0});
  if(data.lastDate!==todayKey()){
    data.history.push({date:todayKey(),completed:totalItems});
    data.sessions++;
    if(data.lastDate){
      const diff=(new Date(todayKey())-new Date(data.lastDate))/(1000*60*60*24);
      data.streak=(diff===1)?(data.streak+1):1;
    } else {data.streak=1;}
    data.lastDate=todayKey();
    storage.set(DATA_KEY,data);refreshTotals();
  }
}
function maybeLogSession(){
  if(document.querySelectorAll('.item input[type=checkbox]:checked').length===totalItems) logSession();
}
function refreshTotals(){
  const data=storage.get(DATA_KEY,{history:[],streak:0,lastDate:null,sessions:0});
  document.getElementById('streak').textContent=data.streak||0;
  document.getElementById('totalSessions').textContent=data.sessions||0;
}
function exportData(){
  const data={plan:PLAN,completions:storage.get(DATA_KEY,{history:[],streak:0,lastDate:null,sessions:0}),today:storage.get(STATE_KEY+'_'+todayKey(),{})};
  const blob=new Blob([JSON.stringify(data,null,2)],{type:'application/json'});
  const url=URL.createObjectURL(blob);const a=document.createElement('a');
  a.href=url;a.download='scapular_rib_progress.json';a.click();URL.revokeObjectURL(url);
}
document.getElementById('markAll').onclick=markAllDone;
document.getElementById('clearToday').onclick=clearToday;
document.getElementById('exportData').onclick=exportData;

document.getElementById('todayDate').textContent=todayKey();
refreshTotals();loadToday();
</script>
</body>
</html>
